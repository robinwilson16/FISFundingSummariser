CREATE VIEW [dbo].[VW_FIS_CollegeStructure]
AS
    SELECT DISTINCT
		AcademicYear = CRS.AcademicYearID,
		ProvSpecValue = CRS.Code,
		CourseCode = CRS.Code,
		CourseTitle = CRS.Name,
		CollegeLevel1Code = COALESCE ( RTRIM ( COL.Code ), '-' ),
		CollegeLevel1Name = COALESCE ( COL.Name, '-- Unknown --' ),
		CollegeLevel2Code = COALESCE ( STE.Code, '-' ),
		CollegeLevel2Name = COALESCE ( STE.Description, '-- Unknown --' ),
		CollegeLevel3Code = COALESCE ( RTRIM ( FAC.Code ), '-' ),
		CollegeLevel3Name = COALESCE ( FAC.Name, '-- Unknown --' ),
		CollegeLevel4Code = COALESCE ( RTRIM ( TEAM.Code ), '-' ),
		CollegeLevel4Name = COALESCE ( TEAM.Name, '-- Unknown --' )
	FROM ProSolution.dbo.Offering CRS
	LEFT JOIN ProSolution.dbo.CollegeLevel TEAM
		ON TEAM.SID = CRS.SID
	LEFT JOIN ProSolution.dbo.CollegeLevel FAC
		ON FAC.SID = TEAM.ParentSID
	LEFT JOIN ProSolution.dbo.CollegeLevel COL
		ON COL.SID = FAC.ParentSID
	LEFT JOIN ProSolution.dbo.Site STE
		ON STE.SiteID = CRS.SiteID